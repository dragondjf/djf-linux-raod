为什么Linux不需要磁盘碎片整理
=======================

####1. 什么是磁盘碎片
**磁盘碎片**应该称为文件碎片，是因为文件被分散保存到整个磁盘的不同地方，而不是连续地保存在磁盘连续的簇中形成的。硬盘在使用一段时间后，由于反复写入和删除文件，磁盘中的空闲扇区会分散到整个磁盘中不连续的物理位置上，从而使文件不能存在连续的扇区里。这样，再读写文件时就需要到不同的地方去读取，增加了磁头的来回移动，降低了磁盘的访问速度。

####2. 磁盘碎片产生的主要原因
+ 主要原因

> 当应用程序所需的物理内存不足时，一般操作系统会在硬盘中产生磁盘临时交换文件，用该文件所占用的硬盘空间虚拟成内存。虚拟内存管理程序会对硬盘频繁读写，产生大量的碎片，这是产生硬盘碎片的主要原因。

+ 其他原因

>  其他如IE浏览器浏览信息时生成的临时文件或临时文件目录的设置也会造成系统中形成大量的碎片。文件碎片一般不会在系统中引起问题，但文件碎片过多会使系统在读文件的时候来回寻找，引起硬盘性能下降，严重的还要缩短硬盘寿命。

####3. 磁盘碎片的危害
如果文件存储在不同的碎片上，那么打开文件时，计算机必须搜索硬盘，以便将碎片重新拼凑在一起，这样可能会导致响应时间变长

####4.为什么Linux不需要磁盘碎片整理

+ Linux文件系统简介
    Linux的文件系统可大致分为两块，inode区域和block区域，分别存着称为inode和block的不同的块。
    
    + inode中存着很多条记录，每条记录用于存放文件除实际内容之外的所有信息，包括权限、修改日期、名称等，一个文件的实际内容可能散落于block区域的不同位置，这些位置的信息也全部记录在inode的一条记录里。
    
    + block区域中是一个个大小固定的块，负责存文件的实际内容。

二者的关系是，inode相当于索引，block中是实际内容。

>Linux的ext2, ext3, 和 ext4 文件系统 ——Ubuntu和大多数最新的Linux发布版中使用的是ext4——采用了一种更聪明的方法来存放文件。与把多个文件并排放在磁盘上不同，Linux文件系统把所有文件都分散到了整个磁盘上，每两个文件之间都留有相当巨大的空闲空间。当文件被修改、体积增加时，它们通常有足够的空间来扩展。一旦有碎片产生时，文件系统会尝试移动整个文件来消除碎片，所以你不需要一个碎片整理工具。


+ Linux与Windows 读取文件对比

    + Linux的处理方式是:
1.在inode区域中找到对应文件
2.得出文件所在的不同的block
3.设计出最佳路径在硬盘上得到(读出)这些block。
    
    + Windows的处理方式是:
1.在分配表中找到对应文件，读取第一个簇。
2.根据记录的下一个簇的位置，移动到下一个位置并读取。
3,重复第二步直到读完文件。

这样区别在于，如果文件在磁盘上比较零散，Windows需要绕更多圈寻找，而Linux可以制定读取顺序，一次全部读出。所以，对于Windows，文件摆放的集中有利于提高读取效率，这就是Windows需要磁盘碎片整理的原因。
